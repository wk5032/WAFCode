<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Wizard</title>
</head>
<body>
    <div class="login-box setting-guide"></div>
<script type="text/javascript">

//<![CDATA[
try{
    $
}catch(e){
    location.href = "/";
};

$(document).ready(function(e){
    var gHTML = "";
    gHTML += "<div class=\"guide-title\">";
    gHTML +=    "<span class=\"text\"></span>";
    gHTML +=    "<a class=\"guide-skip\" href=\"#\"></a>";
    gHTML += "</div>";
    gHTML += "<div class=\"guide-step\"></div>";
    gHTML += "<div class=\"guide-main\">";
    gHTML +=    "<div class=\"guide-content\"></div>";
    gHTML +=    "<div class=\"guide-control\">";
    gHTML +=        "<div id=\"guide-notnow\"></div>";
    gHTML +=        "<button type=\"button\" id=\"guide-prev\"></button>";
    gHTML +=        "<button type=\"button\" id=\"guide-next\"></button>";
    gHTML +=    "</div>"
    gHTML += "</div>";
    gHTML += "<div id=\"no-password-msg\">";
    gHTML +=    "<div id=\"no-password-msg-content\"></div>";
    gHTML += "</div>";
    gHTML += "<div id=\"exit-msg\">";
    gHTML +=    "<div id=\"exit-msg-content\"></div>";
    gHTML += "</div>";


    $(".login-box").html(gHTML);
    $(".guide-title span.text").text($.su.CHAR.WIZARD.WIZARD);
    $(".guide-control #guide-notnow").text($.su.CHAR.LOGIN.NOTNOW).hide();

    var current_wan = 1;
    var wan_mode = $.su.wanCount;
    var current_step = "wan_mode";
    var guide_data = {};
    var WIFI_NAME_5 = "";
    var WIFI_NAME_2 = "";
    var GUEST_NAME = "";
    var WIRELESS_URL = $.su.url("/admin/wlan_state?form=main_ssid");
    var WIRELESS_PROXY = new $.su.Proxy({
        url: WIRELESS_URL
    });

    WIRELESS_PROXY.read({}, function(data){
        guide_data.wireless_info = {};
        guide_data.wireless_info.name_2_4 = data["2.4G"];
        guide_data.wireless_info.name_5 = data["5G"];
        guide_data.wireless_info.pwd_sync = "on";
        WIFI_NAME_2 = data["2.4G"];
        WIFI_NAME_5 = data["5G"];
        guide_data.guest_info = {};
        guide_data.guest_info.name_guest = data["guest"] || "HIHTTPS-GUEST";
        GUEST_NAME = data["guest"] || "HIHTTPS-GUEST";
    });

    var GUIDE_URL = $.su.url('/admin/wizard?form=wizard');

    var GUIDE_PROXY = new $.su.Proxy({
        url: GUIDE_URL
    });
	
	var LAN_URL = $.su.url('/admin/dhcps?form=lan');
    var LAN_PROXY = new $.su.Proxy({
        url: LAN_URL
    });

    var stepHTML = "";
    for(var i = 0; i < 5; i++){
        if((i == 0 ) && $.su.singleWan == 1){
            continue;
        } 
        if((i == 2 || i == 3 ) && $.su.radioCount == 0){
            continue;
        }     
        stepHTML += "<div class=\"guide-step-box\" id=\"step-" + i + "\">";
        stepHTML +=     "<span class=\"icon\"></span>";
        stepHTML +=     "<span class=\"text\">" + $.su.CHAR.LOGIN["W_STEP_"+i] + "</span>";
        if(i < 4){
           stepHTML +=     "<div class=\"line\"></div>"; 
        }   
        stepHTML += "</div>";
    }
    $(".guide-step").html(stepHTML);

    $(".guide-step-box:first").css("marginTop", "60px").addClass("selected");

    var next_btn = $("#guide-next").button({
        text:$.su.CHAR.LOGIN.NEXT,
        cls:"inline",
        handler:function(){
            switch(current_step){
                case "wan_mode":
                    /*加载后一页*/
                    wan_setting();
                    current_step = "wan_setting";
                    prev_btn.button("show");
                    $(".guide-control #guide-notnow").show();
                    $("#step-0").removeClass("selected");
                    $("#step-0").addClass("finished");
                    $("#step-1").addClass("selected");
                    guide_data.txt_wan_num = wan_mode;
                    if(guide_data.wan1_info){
                        get_wan_data();
                    }
                    break;
                case "wan_setting":
                    if(!validate_wan()){
                        return false;
                    }

                    /*检查并保存当前页数据*/
                    var tmp_wan_data = set_wan_data();
                    if (tmp_wan_data.connect == "static") {
                        /* 先检查是否与LAN同网段 */
                        LAN_PROXY.read({}, function(data){
                            var lan_ipaddr = data.ipaddr;
                            var lan_netmask = data.netmask;

                            var smaller_mask = $.su.func.ipToInt(lan_netmask) < $.su.func.ipToInt(tmp_wan_data.mask) 
                                                    ? $.su.func.ipToInt(lan_netmask) : $.su.func.ipToInt(tmp_wan_data.mask);

                            if (($.su.func.ipToInt(lan_ipaddr) & smaller_mask) != ($.su.func.ipToInt(tmp_wan_data.ip) & smaller_mask))
                            {
                                var wan_check_count = 1;
                                var sameip_with_other_wan = 0; /*再检查是否与其他WAN的静态IP相同, 不相同为0*/
                                for (wan_check_count = 1; wan_check_count <= wan_mode; wan_check_count++)
                                {
                                    if ((guide_data["wan" + wan_check_count + "_info"] != null) &&
                                        (guide_data["wan" + wan_check_count + "_info"].connect == "static") && 
                                        (wan_check_count != current_wan))
                                    {
                                        if (guide_data["wan" + wan_check_count + "_info"].ip == tmp_wan_data.ip)
                                        {
                                            sameip_with_other_wan = 1;
                                            $("#w-static-ip").textbox("setError", "此IP已有其他WAN接口进行过设置。");
                                            break;
                                        }
                                    }
                                }
                                if (sameip_with_other_wan == 0)
                                {
                                    guide_data["wan" + current_wan + "_info"] = tmp_wan_data;
                                    if(current_wan < wan_mode){ 
                                        /*加载后一页*/    
                                        current_step = "wan_setting";
                                        current_wan++;
                                        wan_setting();
                                        if(guide_data["wan" + current_wan + "_info"]){
                                            get_wan_data();
                                        }
                                    }else{
                                        current_step = "finish_setting";
                                        finish_setting();
                                        $(".guide-control #guide-notnow").hide();
                                        /*进度切换*/
                                        $("#step-3").removeClass("selected");
                                        $("#step-3").addClass("finished");
                                        $("#step-4").addClass("selected");
                                        /*加载后一页*/
                                        $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                                    }
                                }
                            }
                            else
                            {
                                $("#w-static-ip").textbox("setError", "禁止设置的IP与LAN接口同一网段。");
                            }
                            
                        },function(error){},function(fail){});
                    }
                    else
                    {
                        guide_data["wan" + current_wan + "_info"] = tmp_wan_data;
                        if(current_wan < wan_mode){ 
                            /*加载后一页*/    
                            current_step = "wan_setting";
                            current_wan++;
                            wan_setting();
                            if(guide_data["wan" + current_wan + "_info"]){
                                get_wan_data();
                            }
                        }else{
                            current_step = "finish_setting";
                            finish_setting();
                            $(".guide-control #guide-notnow").hide();
                            /*进度切换*/
                            $("#step-3").removeClass("selected");
                            $("#step-3").addClass("finished");
                            $("#step-4").addClass("selected");
                            $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                        }   
                    }
                    prev_btn.button("show");
                    break;
                case "wifi_setting":
                    if(!validate_wifi()){
                        return false;
                    }
                    if(no_password_wifi()){
                        $("#no-password-msg").msg("show");
                        $("#no-password-msg-content").text($.su.CHAR.LOGIN.NO_PASSWD_CONTNET);
                        return false;
                    }
                    /*保存当前页数据*/
                    guide_data.wireless_info = set_wifi_data();
                    guest_setting();
                    if(guide_data.guest_info){
                        get_guest_data();
                    }
                    current_step = "guest_setting";
                    $("#step-2").removeClass("selected");
                    $("#step-2").addClass("finished");
                    $("#step-3").addClass("selected");
                    break;
                case "guest_setting":
                    if(!validate_guest()){
                        return false;
                    }
                    if(no_password_guest()){
                        $("#no-password-msg").msg("show");
                        $("#no-password-msg-content").text($.su.CHAR.LOGIN.NO_PASSWD_CONTNET);
                        return false;
                    }
                    /*保存当前页数据*/
                    guide_data.guest_info = set_guest_data();
                    /*加载后一页*/
                    current_step = "finish_setting";
                    finish_setting();
                    $(".guide-control #guide-notnow").hide();
                    /*进度切换*/
                    $("#step-3").removeClass("selected");
                    $("#step-3").addClass("finished");
                    $("#step-4").addClass("selected");
                    $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                    break;
                case "finish_setting":
                    prev_btn.button("hide");
                    next_btn.button("hide");
                    $("#step-4").removeClass("selected");
                    $("#step-4").addClass("finished");
                    GUIDE_PROXY.write({params: guide_data});
                    end_setting();

            }
        }
    });

    var prev_btn = $("#guide-prev").button({
        text:$.su.CHAR.LOGIN.PREV,
        cls:"inline prev",
        handler:function(){
            switch(current_step){
                case "wan_setting":         
                    if(current_wan == 1){
                        /*保存当前页数据*/
                        var wan_info = "wan" + current_wan + "_info";
                        guide_data[wan_info] = set_wan_data(); 
                        /*载入前一页*/   
                        interface_mode();        
                        current_step = "wan_mode";
                        prev_btn.button("hide");
                        $(".guide-control #guide-notnow").hide();
                        /*进度切换*/
                        $("#step-1").removeClass("selected");
                        $("#step-0").removeClass("finished");
                        $("#step-0").addClass("selected");                                      
                    }else{
                        /*保存当前页数据*/
                        guide_data["wan" + current_wan + "_info"] = set_wan_data();
                        /*载入前一页*/
                        current_wan--;
                        wan_setting(); 
                        if(!guide_data["wan" + current_wan + "_info"].notset){
                            get_wan_data();
                        }
                        current_step = "wan_setting";
                        
                    }     
                    break;
                case "wifi_setting":
                    /*保存当前页数据*/
                    guide_data.wireless_info = set_wifi_data();
                    /*载入前一页*/
                    wan_setting();
                    if(!guide_data["wan" + current_wan + "_info"].notset){
                        get_wan_data();
                    }
                    current_step = "wan_setting";
                    /*进度切换*/
                    $("#step-2").removeClass("selected");
                    $("#step-1").removeClass("finished");
                    $("#step-1").addClass("selected"); 
                    break;
                case "guest_setting":
                    wifi_setting();
                    get_wifi_data();
                    current_step = "wifi_setting";
                    $("#step-3").removeClass("selected");
                    $("#step-2").removeClass("finished");
                    $("#step-2").addClass("selected"); 
                    break;
                case "finish_setting":
                    if($.su.radioCount > 0){
                        /*载入前一页*/
                        guest_setting();
                        current_step = "guest_setting";  
                        if(guide_data.guest_info){
                            get_guest_data();
                        }                    
                        /*进度切换*/
                        $("#step-4").removeClass("selected");
                        $("#step-3").removeClass("finished");
                        $("#step-3").addClass("selected"); 
                    }else{
                        wan_setting();
                        if(!guide_data["wan" + current_wan + "_info"].notset){
                            get_wan_data();
                        }
                        current_step = "wan_setting";
                        /*进度切换*/
                        $("#step-4").removeClass("selected");
                        $("#step-2").removeClass("selected");
                        $("#step-2").removeClass("finished");
                        $("#step-1").removeClass("finished");
                        $("#step-1").addClass("selected"); 
                    }
                    $("#guide-next .text").text($.su.CHAR.LOGIN.NEXT);
                    $(".guide-control #guide-notnow").show();
                    if($.su.singleWan){
                        prev_btn.button("hide");
                    }
                    break;
            }
        }
    });

    /*暂不设置按钮*/
    $(".guide-control").delegate("#guide-notnow", "click", function(e){
        switch(current_step){
            case "wan_setting":
                if(!guide_data["wan" + current_wan + "_info"]){
                    guide_data["wan" + current_wan + "_info"] = {};
                }
                guide_data["wan" + current_wan + "_info"].notset = true;
                if(current_wan < wan_mode){ 
                    /*加载后一页*/    
                    current_step = "wan_setting";
                    current_wan++;
                    wan_setting();
                    if(guide_data["wan" + current_wan + "_info"]){
                        get_wan_data();
                    }
                }else{
                    /*进度切换*/
                    $("#step-1").removeClass("selected");
                    $("#step-1").addClass("finished");
                    $("#step-2").addClass("selected");
                    /*加载后一页*/
                    if($.su.radioCount > 0){
                        current_step = "wifi_setting";
                        wifi_setting();
                        if(guide_data.wireless_info){
                            get_wifi_data();
                        }
                    }else{
                        current_step = "finish_setting";
                        finish_setting();
                        $("#step-4").addClass("selected");
                        $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                        $(".guide-control #guide-notnow").hide();
                    }
                    
                    
                }
                prev_btn.button("show");
                break;
            case "wifi_setting":
                /*保存当前页数据*/
                guide_data.wireless_info.name_2_4 = WIFI_NAME_2;
                guide_data.wireless_info.name_5 = WIFI_NAME_5;
                guide_data.wireless_info.notset = true;
                
                /*加载后一页*/
                current_step = "guest_setting";
                guest_setting();
                if(guide_data.guest_info){
                    get_guest_data();
                }
                
                /*进度切换*/
                $("#step-2").removeClass("selected");
                $("#step-2").addClass("finished");
                $("#step-3").addClass("selected");
                break;
            case "guest_setting":
                guide_data.guest_info.name_guest = GUEST_NAME;
                guide_data.guest_info.notset = true;
                current_step = "finish_setting";
                $(".guide-control #guide-notnow").hide();
                finish_setting();

                /*进度切换*/
                $("#step-3").removeClass("selected");
                $("#step-3").addClass("finished");
                $("#step-4").addClass("selected");
                $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                break;
        }
    });

    prev_btn.button("hide");


    $("#no-password-msg").msg({
        showHead: true,
        title: $.su.CHAR.LOGIN.NO_PASSWD_MSG_TITLE,
        type: "confirm",
        cls: "l",
        yesText:$.su.CHAR.LOGIN.NO_PASSWD_MSG_YES,
        noText:$.su.CHAR.LOGIN.NO_PASSWD_MSG_NO,
        noHandler:function(){
            switch(current_step){
                case "wifi_setting":
                    /*保存当前页数据*/
                    guide_data.wireless_info = set_wifi_data();
                    /*加载后一页*/
                    current_step = "guest_setting";
                    guest_setting();
                    get_guest_data();
                    /*进度切换*/
                    $("#step-2").removeClass("selected");
                    $("#step-2").addClass("finished");
                    $("#step-3").addClass("selected");
                    break;
                case "guest_setting":
                    /*保存当前页数据*/
                    guide_data.guest_info = set_guest_data();
                    /*加载后一页*/
                    current_step = "finish_setting";
                    finish_setting();
                    $(".guide-control #guide-notnow").hide();
                    /*进度切换*/
                    $("#step-3").removeClass("selected");
                    $("#step-3").addClass("finished");
                    $("#step-4").addClass("selected");
                    $("#guide-next .text").text($.su.CHAR.LOGIN.FINISH);
                    break;
            }
        },
        okHandler:function(){
            
        }
    });

    var exit_msg = $("#exit-msg").msg({
        showHead: true,
        title: $.su.CHAR.WIZARD.EXIT,
        type: "confirm",
        cls: "l",
        yesText:$.su.CHAR.WIZARD.EXIT_YES,
        noText:$.su.CHAR.WIZARD.EXIT_NO,
        global:true,
        noHandler:function(){
            $.su.wizard.msg.msg("close");
            setTimeout(function() {
                $("#exit-msg").remove();
                $("#no-password-msg").remove();
            }, 500);     
        },
        okHandler:function(){
            
        }
    });

    

    

    $("a.guide-skip").click(function(e){
        exit_msg.msg("show");
        $("#exit-msg-content").text($.su.CHAR.WIZARD.EXIT_CONTENT);
    });

    /*steps*/
    function interface_mode(){
        var pHTML = "<div class=\"interface-mode-small\"></div>";
        pHTML += "<input id=\"wan-select\" name=\"wanmode\">";

        $(".guide-content").html(pHTML);
        
        var wan_select = $(".guide-content #wan-select").radio({
            fieldLabel: $.su.CHAR.WAN_MODE.COUNT,
            columns:1,              
            items: [
                {boxlabel:$.su.CHAR.WAN_MODE.COUNT1,inputValue:1},
                {boxlabel:$.su.CHAR.WAN_MODE.COUNT2,inputValue:2},
                {boxlabel:$.su.CHAR.WAN_MODE.COUNT3,inputValue:3},
                {boxlabel:$.su.CHAR.WAN_MODE.COUNT4,inputValue:4}
            ]
        }).on("ev_change", function(e, oldValue, newValue){
            refresh_wan(parseInt(newValue), $.su.interfaceCount);
            if(wan_mode && newValue){
                wan_mode = parseInt(newValue);
            }       
        });
        wan_select.radio("setValue", wan_mode);
    }


    function wan_setting(){
        var wan_id = current_wan || 1;
        var pHTML = "<div class=\"interface-mode-small\"></div>";
        pHTML += "<form id=\"wan-form\">";
        pHTML += "<input id=\"w-connect-type\" name=\"connect-type\" />";
        pHTML += "<input id=\"w-pppoe-user\" name=\"pppoe-user\" />";
        pHTML += "<input id=\"w-pppoe-pass\" name=\"pppoe-pass\" />";
        pHTML += "<input id=\"w-static-ip\" name=\"static-ip\" />";
        pHTML += "<input id=\"w-static-mask\" name=\"static-mask\" />";
        pHTML += "<input id=\"w-static-gateway\" name=\"static-gateway\" />";
        pHTML += "<input id=\"w-static-dns1\" name=\"static-dns1\" />";
        pHTML += "<input id=\"w-static-dns2\" name=\"static-dns2\" />";
        pHTML += "</form>";

        $(".guide-content").html(pHTML);
        refresh_all(wan_id, wan_mode, $.su.interfaceCount);


        var connect_type = $("#w-connect-type").combobox({
            fieldLabel: $.su.CHAR.LOGIN.CONN_TYPE,
            alwaysTrigger: true,
            items:[
                {name: $.su.CHAR.LOGIN.PPPOE, value:"pppoe", selected:true},
                {name: $.su.CHAR.LOGIN.DHCP, value:"dhcp"},
                {name: $.su.CHAR.LOGIN.STATIC, value:"static"}
            ]
        }).on("ev_change", function(e, oldValue, newValue){
            pppoe_user.textbox("hide").textbox("disable");
            pppoe_pass.password("hide").password("disable");
            static_ip.textbox("hide").textbox("disable");
            static_mask.textbox("hide").textbox("disable")
            static_gateway.textbox("hide").textbox("disable");
            static_dns1.textbox("hide").textbox("disable");
            static_dns2.textbox("hide").textbox("disable");
            switch(newValue[0]){
                case "pppoe": 
                    pppoe_user.textbox("show").textbox("enable");
                    pppoe_pass.password("show").password("enable");
                    break;
                case "static":
                    static_ip.textbox("show").textbox("enable");
                    static_mask.textbox("show").textbox("enable");
                    static_gateway.textbox("show").textbox("enable");
                    static_dns1.textbox("show").textbox("enable");
                    static_dns2.textbox("show").textbox("enable");
                    break;
            }
        });

        var pppoe_user = $("#w-pppoe-user").textbox({
            fieldLabel: $.su.CHAR.LOGIN.PPPOE_USER,
            maxLength: 64,
            vtype:"pppoe_username",
            allowBlank: false
        });

        var pppoe_pass = $("#w-pppoe-pass").password({
            fieldLabel: $.su.CHAR.LOGIN.PPPOE_PASS,
            allowBlank: false,
            maxLength: 128,
            allowVisible: true,
            showLevel: false
        });


        var static_ip = $("#w-static-ip").textbox({
            fieldLabel: $.su.CHAR.LOGIN.STATIC_IP,
            allowBlank: false,
            vtype: "ip"
        }).textbox("hide");

        var static_mask = $("#w-static-mask").textbox({
            fieldLabel: $.su.CHAR.LOGIN.STATIC_MASK,
            allowBlank: false,
            vtype: "netmask"
        }).textbox("hide");

        var static_gateway = $("#w-static-gateway").textbox({
            fieldLabel: $.su.CHAR.LOGIN.STATIC_GATEWAY,
            vtype: "ip",
            tips: $.su.CHAR.LOGIN.OPTION,
            tipsCls:"xxs"
        }).textbox("hide");

        var static_dns1 = $("#w-static-dns1").textbox({
            fieldLabel: $.su.CHAR.LOGIN.STATIC_DNS1,
            vtype: "ip",
            tips: $.su.CHAR.LOGIN.OPTION,
            tipsCls:"xxs"
        }).textbox("hide");

        var static_dns2 = $("#w-static-dns2").textbox({
            fieldLabel: $.su.CHAR.LOGIN.STATIC_DNS2,
            vtype: "ip",
            tips: $.su.CHAR.LOGIN.OPTION,
            tipsCls:"xxs"
        }).textbox("hide");

    }



    function wifi_setting(){
        var wHTML = "<div class=\"wireless-guide\" id=\"wifi-2\">";
        wHTML += "<h1></h1>";
        wHTML += "<div class=\"wireless-guide-content\">";
        wHTML += "<input id=\"wifi-2-name\" name=\"wifi-2-name\"/>";
        wHTML += "<input id=\"wifi-2-pass\" name=\"wifi-2-pass\"/>";
        wHTML += "</div>";
        wHTML += "</div>";

        wHTML += "<div class=\"wireless-guide\" id=\"wifi-5\">";
        wHTML += "<h1></h1>";
        wHTML += "<div class=\"wireless-guide-content\">";
        wHTML += "<input id=\"wifi-5-name\" name=\"wifi-5-name\"/>";
        wHTML += "<input id=\"wifi-5-pass\" name=\"wifi-5-pass\"/>";
        wHTML += "<input id=\"wifi-5-same\" name=\"wifi-5-same\"/>";
        wHTML += "</div>";
        wHTML += "</div>";



        $(".guide-content").html(wHTML);
        $("#wifi-2 h1").text($.su.CHAR.LOGIN.WIFI_2);
        $("#wifi-5 h1").text($.su.CHAR.LOGIN.WIFI_5);
        if($.su.radioCount == 1){
            $("#wifi-2 h1").text($.su.CHAR.LOGIN.STEP_2);
            $("#wifi-5").hide();
        }

        $("#wifi-2-name").textbox({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_NAME,
            vtype:"string_wireless_name",
            maxLength: 32,
            allowBlank: false
        });

        $("#wifi-2-pass").password({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_PASS,
            allowVisible: true,
            vtype:"strange_pwd",
            validator:function(v){
                if(v.length < 8){
                    return $.su.CHAR.LOGIN.WIFI_PASS_TOO_SHORT;
                }
                return true;
            }
        });

        $("#wifi-5-name").textbox({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_NAME,
            vtype:"string_wireless_name",
            maxLength: 32,
            allowBlank: false
        });

        var wifi_5_pass = $("#wifi-5-pass").password({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_PASS,
            allowVisible: true,
            cls:"inline",
            vtype:"strange_pwd",
            validator:function(v){
                if(v.length < 8){
                    return $.su.CHAR.LOGIN.WIFI_PASS_TOO_SHORT;
                }
                return true;
            }
        }).password("disable");

        $("#wifi-5-same").checkbox({
            fieldLabel:"",
            labelCls:"inline xxxxs",
            items:[
                {boxlabel: $.su.CHAR.LOGIN.WIFI_SAME, inputValue:"same", uncheckedValue:"diff", checked:true}
            ],
            cls:"inline"
        }).on("ev_change", function(e, oldValue, newValue){
            if(newValue[0] == "wifi-5-same"){
                wifi_5_pass.password("disable");
            }else{
                wifi_5_pass.password("enable");
            }
        });

        if($.su.radioCount ==1){
            $("#wifi-5-name").textbox("hide");
            $("#wifi-5-pass").password("hide");
            $("#wifi-5-same").checkbox("hide");
        }

        
    }

    function guest_setting(){
        var uHTML = "<div class=\"wireless-guide\" id=\"wifi-guest\">";
        uHTML += "<h1></h1>";
        uHTML += "<div class=\"wireless-guide-content\">";
        uHTML += "<input id=\"wifi-guest-name\" name=\"wifi-guest-name\"/>";
        uHTML += "<input id=\"wifi-guest-pass\" name=\"wifi-guest-pass\"/>";
        uHTML += "<input id=\"wifi-guest-enable\" name=\"wifi-guest-enable\"/>";
        uHTML += "</div>";
        uHTML += "</div>";

        $(".guide-content").html(uHTML);
        $("#wifi-guest h1").text($.su.CHAR.LOGIN.WIFI_GUEST);

        $("#wifi-guest-name").textbox({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_NAME,
            vtype:"string_wireless_name",
            maxLength: 32,
            allowBlank: false
        });

        $("#wifi-guest-pass").password({
            fieldLabel: $.su.CHAR.LOGIN.WIFI_PASS,
            allowVisible: true,
            vtype:"strange_pwd",
            validator:function(v){
                if(v.length < 8){
                    return $.su.CHAR.LOGIN.WIFI_PASS_TOO_SHORT;
                }
                return true;
            }
        });

        $("#wifi-guest-enable").switchbutton({
            fieldLabel:$.su.CHAR.LOGIN.WIFI_GUEST_STATE,
            defaultValue:"off"
        });

    }

    function finish_setting(){
        var fHTML = "<div class=\"guide-finish\" id=\"interface\">";
        fHTML += "<h1></h1>";
        fHTML += "</div>";
        if($.su.radioCount > 0){
            fHTML += "<div class=\"guide-finish\" id=\"wireless\">";
            fHTML += "<h1></h1>";
            fHTML += "</div>";
        }
        

        $(".guide-content").html(fHTML);
        $(".guide-finish#interface h1").text($.su.CHAR.LOGIN.INTERFACE);
        if($.su.radioCount > 0){
            $(".guide-finish#wireless h1").text($.su.CHAR.LOGIN.WIRELESS);
        }
         
        for(var i = 0; i < guide_data.txt_wan_num; i++){
            var data = guide_data["wan" + (i+1) + "_info"];
            fHTML  = "<table id=\"WAN-" + (i+1) + "\" class=\"interface-wan\">";
            fHTML += "<tr>";
            if($.su.singleWan){
                fHTML += "<td class=\"column1\">WAN" + "</td>";
            }else{
                fHTML += "<td class=\"column1\">WAN" + (i+1) + "</td>";
            }
            if(data && data.connect && !data.notset){
                fHTML += "<td class=\"column2\">" + $.su.CHAR.LOGIN[(data.connect).toUpperCase()] + "</td>";
            }else{
                fHTML += "<td class=\"column2\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
            }
            
            fHTML += "</tr>";
            if(data && data.connect == "pppoe" && !data.notset){
                fHTML += "<tr>";
                fHTML += "<td class=\"column1\">" + $.su.CHAR.LOGIN.PPPOE_USER + "</td>";
                fHTML += "<td class=\"column2\">" + data.user + "</td>";
                fHTML += "</tr>";
                fHTML += "<tr>";
                fHTML += "<td class=\"column1\">" + $.su.CHAR.LOGIN.PPPOE_PASS + "</td>";
                fHTML += "<td class=\"column2\">" + data.password + "</td>";
                fHTML += "</tr>";
            }
            if(data && data.connect == "static" && !data.notset){
                fHTML += "<tr>";
                fHTML += "<td class=\"column1\">" + $.su.CHAR.LOGIN.STATIC_IP + "</td>";
                fHTML += "<td class=\"column2\">" + data.ip + "</td>";
                fHTML += "</tr>";
                fHTML += "<tr>";
                fHTML += "<td class=\"column1\">" + $.su.CHAR.LOGIN.STATIC_MASK + "</td>";
                fHTML += "<td class=\"column2\">" + data.mask + "</td>";
                fHTML += "</tr>";
            }

            fHTML += "</table>";
            $(".guide-finish#interface").append(fHTML);
        }

        var wifi_data = guide_data.wireless_info;
        if($.su.radioCount > 1){
            fHTML  = "<table id=\"wifi-2\" class=\"wifi\">";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_2_NAME + "</td>";
            fHTML += "<td class=\"column4\">" + wifi_data.name_2_4 + "</td>";
            fHTML += "</tr>";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_2_PASS + "</td>";
            if(wifi_data.notset){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
            }else if(wifi_data.pwd_2_4 == ""){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_ENCRYPT + "</td>";
            }else{
                fHTML += "<td class=\"column4\">" + wifi_data.pwd_2_4 + "</td>";
            }
            fHTML += "</tr>";
            fHTML += "</table>";
        
            fHTML += "<table id=\"wifi-5\" class=\"wifi\">";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_5_NAME + "</td>";
            fHTML += "<td class=\"column4\">" + wifi_data.name_5 + "</td>";
            fHTML += "</tr>";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_5_PASS + "</td>";
            if(wifi_data.pwd_sync == "on"){
                if(wifi_data.notset){
                    fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
                }else if(wifi_data.pwd_2_4 == ""){
                    fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_ENCRYPT + "</td>";
                }else{
                    fHTML += "<td class=\"column4\">" + wifi_data.pwd_2_4 + "</td>";
                }
            }else{
                if(wifi_data.notset){
                    fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
                }else if(wifi_data.pwd_5 == ""){
                    fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_ENCRYPT + "</td>";
                }else{
                    fHTML += "<td class=\"column4\">" + wifi_data.pwd_5 + "</td>";
                }
            }
        }else if($.su.radioCount > 0){
            fHTML  = "<table id=\"wifi-2\" class=\"wifi\">";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_NAME + "</td>";
            fHTML += "<td class=\"column4\">" + wifi_data.name_2_4 + "</td>";
            fHTML += "</tr>";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_PASS + "</td>";
            if(wifi_data.notset){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
            }else if(wifi_data.pwd_2_4 == ""){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_ENCRYPT + "</td>";
            }else{
                fHTML += "<td class=\"column4\">" + wifi_data.pwd_2_4 + "</td>";
            }
            fHTML += "</tr>";
            fHTML += "</table>";
        }
        

        if($.su.radioCount > 0){
            fHTML += "<table id=\"wifi-guest\" class=\"wifi\">";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_GUEST_NAME + "</td>";
            fHTML += "<td class=\"column4\">" + guide_data.guest_info.name_guest + "</td>";
            fHTML += "</tr>";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_GUEST_PASS + "</td>";
            if(guide_data.guest_info.notset){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_SETTING + "</td>";
            }else if(guide_data.guest_info.pwd_guest == ""){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.NO_ENCRYPT + "</td>";
            }else{
                fHTML += "<td class=\"column4\">" + guide_data.guest_info.pwd_guest + "</td>";
            }
            fHTML += "</tr>";
            fHTML += "<tr>";
            fHTML += "<td class=\"column3\">" + $.su.CHAR.LOGIN.WIFI_GUEST_STATE + "</td>";
            if(guide_data.guest_info.enable_guest == "on"){
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.WIFI_GUEST_ON + "</td>";
            }else{
                fHTML += "<td class=\"column4\">" + $.su.CHAR.LOGIN.WIFI_GUEST_OFF + "</td>";
            }   
            fHTML += "</tr>";
            fHTML += "</table>";
        }

        $(".guide-finish#wireless").append(fHTML);
    }

    function end_setting(){
        var eHTML = "<div class=\"end-setting\">";
        eHTML += "<div id=\"progress-text\"></div>";
        eHTML += "<div id=\"progress\"></div>";
        eHTML += "</div>";

        $(".guide-content").html(eHTML);
        $("a.guide-skip").hide();
        
        if(guide_data.txt_wan_num != parseInt($.su.wanCount)){
            $("#progress-text").text($.su.CHAR.LOGIN.REBOOT_TEXT);
            setTimeout(function() {
                location.href = "./login.html";
            }, 160000);
        }else{
            $("#progress-text").text($.su.CHAR.LOGIN.SET_TEXT);
            setTimeout(function() {
                location.href = "./index.html";
            }, 20000);
        }

        var scan_pro = $("#progress").waitingbar({
            fieldLabel:"",
            labelCls:"hidden",
            barWidth: 400
        });

        scan_pro.waitingbar("run");
        
        $("#exit-msg").remove();
        $("#no-password-msg").remove();
    }


    /*wan_data*/
    function set_wan_data(){
        var conn_type = $("#w-connect-type").combobox("getValue");
        conn_type = conn_type[0];
        var ret = {};
        ret.connect = conn_type;
        ret.notset = false;
        switch(conn_type){
            case "pppoe":
                ret.user = $("#w-pppoe-user").textbox("getValue");
                ret.password = $("#w-pppoe-pass").password("getValue");
                break;
            case "static":
                ret.ip = $("#w-static-ip").textbox("getValue");
                ret.mask = $("#w-static-mask").textbox("getValue");
                ret.gateway = $("#w-static-gateway").textbox("getValue");
                ret.first_dns = $("#w-static-dns1").textbox("getValue");
                ret.second_dns = $("#w-static-dns2").textbox("getValue");
                break;
        }
        return ret;
    }

    function get_wan_data(){
        var current_data = guide_data["wan" + current_wan + "_info"];
        if(!current_data){
            return false;
        }
        $("#w-connect-type").combobox("setValue", current_data.connect);
        switch(current_data.connect){
            case "pppoe":
                if(current_data.user){
                    $("#w-pppoe-user").textbox("setValue", current_data.user);
                }
                if(current_data.password){
                    $("#w-pppoe-pass").password("setValue", current_data.password);
                }
                break;
            case "static":
                if(current_data.ip){
                    $("#w-static-ip").textbox("setValue", current_data.ip);
                }
                if(current_data.mask){
                    $("#w-static-mask").textbox("setValue", current_data.mask);
                }
                if(current_data.gateway){
                    $("#w-static-gateway").textbox("setValue", current_data.gateway);
                }
                if(current_data.first_dns){
                    $("#w-static-dns1").textbox("setValue", current_data.first_dns);
                }
                if(current_data.second_dns){
                    $("#w-static-dns2").textbox("setValue", current_data.second_dns);
                }   
                break;
        }
    }


    function set_wifi_data(){
        var ret = {};
        ret.name_2_4 = $("#wifi-2-name").textbox("getValue");
        ret.encode_2_4 = get_ssid_encode(ret.name_2_4);
        ret.pwd_2_4 = $("#wifi-2-pass").password("getValue");
        ret.name_5 = $("#wifi-5-name").textbox("getValue");
        ret.encode_5 = get_ssid_encode(ret.name_5);
        ret.notset = false;
        if($("#wifi-5-same").checkbox("getValue1") == "same"){
            ret.pwd_sync = "on";
        }else{
            ret.pwd_5 = $("#wifi-5-pass").password("getValue");
        }

        return ret;
    }

    function get_wifi_data(){
        var wifi_data = guide_data.wireless_info;
        if(wifi_data.name_2_4){
            $("#wifi-2-name").textbox("setValue", wifi_data.name_2_4);
        }
        if(wifi_data.pwd_2_4){
            $("#wifi-2-pass").password("setValue", wifi_data.pwd_2_4);
        }
        if(wifi_data.name_5){
            $("#wifi-5-name").textbox("setValue", wifi_data.name_5);
        }
        if(wifi_data.pwd_5){
            $("#wifi-5-pass").password("setValue", wifi_data.pwd_5);
        }
        if(wifi_data.pwd_sync){
            $("#wifi-5-same").checkbox("setValue", "same");
            $("#wifi-5-pass").password("disable");
        }else{
            $("#wifi-5-pass").password("enable");
            $("#wifi-5-same").checkbox("setValue", "diff");
        }
        
    }

    function set_guest_data(){
        var ret = {};
        ret.name_guest = $("#wifi-guest-name").textbox("getValue");
        ret.encode_guest = get_ssid_encode(ret.name_guest);
        ret.pwd_guest = $("#wifi-guest-pass").password("getValue");
        ret.enable_guest = $("#wifi-guest-enable").switchbutton("getValue");
        ret.notset = false;
        return ret;
    }

    function get_guest_data(){
        var wifi_data = guide_data.guest_info;
        if(wifi_data.name_guest){
            $("#wifi-guest-name").textbox("setValue", wifi_data.name_guest);
        }
        if(wifi_data.pwd_guest){
            $("#wifi-guest-pass").password("setValue", wifi_data.pwd_guest);
        }
        if(wifi_data.enable_guest){
            $("#wifi-guest-enable").switchbutton("setValue", wifi_data.enable_guest);
        }        
    }






    /*validate function*/
    function validate_wan(){
        var conn_type = $("#w-connect-type").combobox("getValue");
        conn_type = conn_type[0];
        switch(conn_type){
            case "pppoe":
                if($("#w-pppoe-user").textbox("validate") && $("#w-pppoe-pass").password("validate")){
                    return true;
                }else{
                    return false;
                }
                break;
            case "static":
                if($("#w-static-ip").textbox("validate") && $("#w-static-mask").textbox("validate") && $("#w-static-gateway").textbox("validate") && $("#w-static-dns1").textbox("validate") && $("#w-static-dns2").textbox("validate")){
                    return true;
                }else{
                    return false;
                }
                break;
            default:
                return true;
        }   
    }


    function validate_wifi(){
        if(!$("#wifi-2-name").textbox("validate") || (!$("#wifi-5-name").textbox("validate") && ($.su.radioCount > 1)) || !$("#wifi-2-pass").password("validate")){
            return false;
        }
        if($("#wifi-5-same").checkbox("getValue1") != ["same"]){
            if(!$("#wifi-5-pass").password("validate")){
                return false;
            }
        }
        return true;
    }

    function no_password_wifi(){
        if($("#wifi-2-pass").password("getValue") == ""){
            return true;
        }
        if($("#wifi-5-same").checkbox("getValue1") != "same" && $("#wifi-5-pass").password("getValue") == ""){
            return true;
        }
        return false;
    }

    function validate_guest(){
        if(!$("#wifi-guest-name").textbox("validate") || !$("#wifi-guest-pass").password("validate")){
            return false;
        }
        return true;
    }

    function no_password_guest(){
        if($("#wifi-guest-pass").password("getValue") == ""){
            return true;
        }
        return false;
    }



    /*refresh function*/
    function refresh_9(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        inHTML += "<div class=\"row-2\"></div>";
        $(".interface-mode-small").addClass("nine");
        $(".interface-mode-small").html(inHTML);
        for(var i = 1; i <= lan_count; i++){
            lanHTML =    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";

            if(i % 2 == 1){
                $(".guide-content .row-1").append(lanHTML);
            }else{
                $(".guide-content .row-2").append(lanHTML);
            }   
        }

        
        for(var i = wan_count; i >= 1; i--){
            wanHTML  =    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            if(i % 2 == 0 || i == 1){
                $(".guide-content .row-2").append(wanHTML);
            }else{
                $(".guide-content .row-1").append(wanHTML);
            }
        }
    }
    function refresh_line_9(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("line-nine");
        $(".interface-mode-small").html(inHTML);

        for(var i = 1; i <= wan_count;  i++){
            wanHTML  =    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
            $(".guide-content .row-1").append(wanHTML);
        }
        for(var i = 1; i <= lan_count; i++){
            lanHTML =    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
            $(".guide-content .row-1").append(lanHTML);  
        }
    }

    function refresh_inverted_line_9(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("line-nine");
        $(".interface-mode-small").html(inHTML);

        
        for(var i = lan_count; i >= 1; i--){
            lanHTML =    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
            $(".guide-content .row-1").append(lanHTML);  
        }
        for(var i = wan_count; i >= 1;  i--){
            wanHTML  =    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan){
                wanHTML += "<h2>WAN</h2>";
            }else{
                wanHTML +=  "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
            $(".guide-content .row-1").append(wanHTML);
        }
    }

    function refresh_inverted_line_5(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").html(inHTML);

        
        for(var i = lan_count; i >= 1; i--){
            lanHTML =    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
            $(".guide-content .row-1").append(lanHTML);  
        }
        for(var i = wan_count; i >= 1;  i--){
            wanHTML  =    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
            $(".guide-content .row-1").append(wanHTML);
        }
    }

    function refresh_8(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("eight");
        $(".interface-mode-small").html(inHTML);

        for(var i = 1; i <= wan_count;  i++){
            wanHTML  =    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
            $(".guide-content .row-1").append(wanHTML);
        }
        for(var i = 1; i <= lan_count; i++){
            lanHTML =    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
            $(".guide-content .row-1").append(lanHTML);  
        }
    }
    function refresh_normal(lan_count, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        for(var i = 1; i <= wan_count; i++){
            wanHTML +=    "<div class=\"interface-box-small wan\">";
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
        }
        $(".interface-mode-small").append(wanHTML);

        for(var i = wan_count + 1; i <= interface_count; i++){
            lanHTML +=    "<div class=\"interface-box-small lan\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
        }
        $(".interface-mode-small").append(lanHTML);
    }
    function refresh_wan(wan_count, interface_count){
        if(typeof wan_count == "undefined" || !wan_count){
            var wan_count = 1;
        }
        if(typeof interface_count == "undefined" || !interface_count){
            var interface_count = 5;
        }

        var lan_count = interface_count - wan_count;
        /*reset box*/
        $(".interface-mode-small").html("");
        /*set box*/
        
        if(-1 != $.su.interfaceModel){
            switch($.su.interfaceModel){
                case 1:
                    refresh_9(lan_count, wan_count, interface_count); 
                    break;
                case 2:
                    refresh_8(lan_count, wan_count, interface_count);
                    break;
                case 3:
                    refresh_line_9(lan_count, wan_count, interface_count);
                    break;
                case 4:
				case 6:
                    refresh_inverted_line_9(lan_count, wan_count, interface_count);
                    break;
                case 5:
                case 7:
                case 8:
                    refresh_inverted_line_5(lan_count, wan_count, interface_count);
                    break;
                default:
                    refresh_normal(lan_count, wan_count, interface_count);
                    break;
            }
        }else{
            switch($.su.interfaceCount){
                case 8:
                    refresh_8(lan_count, wan_count, interface_count);
                    break;
                case 9:
                    refresh_9(lan_count, wan_count, interface_count); 
                    break;
                default:
                    refresh_normal(lan_count, wan_count, interface_count);
                    break;
            }
        }  
    }



    /*refresh all*/
    function refresh_all_normal(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        for(var i = 1; i <= wan_count; i++){
            if(wan_id == i){
                wanHTML +=    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML +=    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=          "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";
        }
        $(".interface-mode-small").append(wanHTML);

        for(var i = wan_count + 1; i <= interface_count; i++){
            lanHTML +=    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
        }
        $(".interface-mode-small").append(lanHTML);    
    }

    function refresh_all_8(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("eight");
        $(".interface-mode-small").html(inHTML);
        for(var i = 1;  i <= wan_count; i++){
            if(wan_id == i){
                wanHTML  =    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML  =    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=    "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            $(".guide-content .row-1").append(wanHTML);
            
        }   
        for(var i = wan_count + 1; i <= interface_count; i++){
            lanHTML  =    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";

            $(".guide-content .row-1").append(lanHTML);
             
        }
    }

    function refresh_all_line_9(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("line-nine");
        $(".interface-mode-small").html(inHTML);
        for(var i = 1;  i <= wan_count; i++){
            if(wan_id == i){
                wanHTML  =    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML  =    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=    "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            $(".guide-content .row-1").append(wanHTML);
            
        }   
        for(var i = wan_count + 1; i <= interface_count; i++){
            lanHTML  =    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";

            $(".guide-content .row-1").append(lanHTML);
             
        }
    }

    function refresh_all_inverted_line_9(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").addClass("line-nine");
        $(".interface-mode-small").html(inHTML);
        for(var i = interface_count; i >= wan_count + 1; i--){
            lanHTML  =    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";

            $(".guide-content .row-1").append(lanHTML);
             
        }
        for(var i = wan_count;  i >= 1; i--){
            if(wan_id == i){
                wanHTML  =    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML  =    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=    "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            $(".guide-content .row-1").append(wanHTML);
            
        }   
        
    }

    function refresh_all_inverted_line_5(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        $(".interface-mode-small").html(inHTML);
        for(var i = interface_count; i >= wan_count + 1; i--){
            lanHTML  =    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";

            $(".guide-content .row-1").append(lanHTML);
             
        }
        for(var i = wan_count;  i >= 1; i--){
            if(wan_id == i){
                wanHTML  =    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML  =    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=    "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            $(".guide-content .row-1").append(wanHTML);
            
        }   
        
    }

    function refresh_all_9(wan_id, wan_count, interface_count){
        var wanHTML = "";
        var lanHTML = "";
        var inHTML = "<div class=\"row-1\"></div>";
        inHTML += "<div class=\"row-2\"></div>";
        $(".interface-mode-small").addClass("nine");
        $(".interface-mode-small").html(inHTML);
        for(var i = wan_count + 1; i <= interface_count; i++){
            lanHTML  =    "<div class=\"interface-box-small lan disabled\">";
            lanHTML +=          "<div class=\"icon\"></div>";
            lanHTML +=          "<h2>LAN</h2>";
            lanHTML +=    "</div>";
            if(i % 2 == 1){
                $(".guide-content .row-1").append(lanHTML);
            }else{
                $(".guide-content .row-2").append(lanHTML);
            }  
        }
         

        for(var i = wan_count; i >= 1; i--){
            if(wan_id == i){
                wanHTML  =    "<div class=\"interface-box-small wan\">";
            }else{
                wanHTML  =    "<div class=\"interface-box-small disabled wan\">";
            }      
            wanHTML +=    "<div class=\"icon\"></div>";
            if($.su.singleWan == 1){
                wanHTML +=          "<h2>WAN</h2>";
            }else{
                wanHTML +=          "<h2>WAN" + i + "</h2>";
            }
            wanHTML +=    "</div>";

            if(i % 2 == 0 || i == 1){
                $(".guide-content .row-2").append(wanHTML);
            }else{
                $(".guide-content .row-1").append(wanHTML);
            }
        }   
    }

    function refresh_all(wan_id, wan_count, interface_count){
        if(typeof wan_id == "undefined" || !wan_id){
            var wan_id = 1;
        }
        if(typeof wan_count == "undefined" || !wan_count){
            var wan_count = 1;
        }
        if(typeof interface_count == "undefined" || !interface_count){
            var interface_count = 5;
        }

        /*reset box*/
        $(".interface-mode-small").html("");
        /*set box*/


        if(-1 != $.su.interfaceModel){
            switch($.su.interfaceModel){
                case 1:
                    refresh_all_9(wan_id, wan_count, interface_count); 
                    break;
                case 2:
                    refresh_all_8(wan_id, wan_count, interface_count);
                    break;
                case 3:
                    refresh_all_line_9(wan_id, wan_count, interface_count);
                    break;
                case 4:
				case 6:
                    refresh_all_inverted_line_9(wan_id, wan_count, interface_count);
                    break;
                case 5:
                case 7:
                case 8:
                    refresh_all_inverted_line_5(wan_id, wan_count, interface_count);
                    break;
                default:
                    refresh_all_normal(wan_id, wan_count, interface_count);
                    break;
            }
        }else{
            switch($.su.interfaceCount){
                case 8:
                    refresh_all_8(wan_id, wan_count, interface_count);
                    break;
                case 9:
                    refresh_all_9(wan_id, wan_count, interface_count); 
                    break;
                default:
                    refresh_all_normal(wan_id, wan_count, interface_count);
                    break;
            }
        }  

        
    }



    function get_ssid_encode(value) {
        if ((/.*[\u4e00-\u9fa5]+.*$/).test(value)){
            return "1";
        }else{
            return "0";
        }
    }

    interface_mode();
    if($.su.singleWan){
        wan_setting();
        current_step = "wan_setting";
        $(".guide-control #guide-notnow").css("marginRight","400px").show();
        guide_data.txt_wan_num = wan_mode;
    }

    
});

//]]>
</script>
</body>

</html>